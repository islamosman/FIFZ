{"version":3,"sources":["../../src/pages/inridestatus/inridestatus.module.ts","../../src/providers/Enums/reservationEnum.ts","../../src/pages/inridestatus/inridestatus.ts"],"names":[],"mappings":"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","file":"5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { InridestatusPage } from './inridestatus';\n\n@NgModule({\n  declarations: [\n    InridestatusPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(InridestatusPage),\n  ],\n})\nexport class InridestatusPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/inridestatus/inridestatus.module.ts","export  enum reservationEnum{\r\n    Start=1,\r\n    End=2,\r\n    TempRequest=3,\r\n    Cancel=4,\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/providers/Enums/reservationEnum.ts","import { Component, OnInit } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, AlertController, ModalController } from 'ionic-angular';\r\nimport { AlertsProvider } from '../../providers/generic/AlertsProvider';\r\nimport { VehiclsProvider } from '../../providers/Map/vechilsApi';\r\nimport { vehicaleReservationModel } from '../../models/vehicaleModel';\r\nimport { UserStateProvider } from '../../providers/userstate/user-state';\r\nimport { Storage } from '@ionic/storage';\r\nimport { reservationEnum } from '../../providers/Enums/reservationEnum';\r\nimport { ResponseModel } from '../../models/ResponseModel';\r\nimport { UserStateModel } from '../../models/usermodel';\r\n\r\n/**\r\n * Generated class for the InridestatusPage page.\r\n *\r\n * See https://ionicframework.com/docs/components/#navigation for more info on\r\n * Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-inridestatus',\r\n  templateUrl: 'inridestatus.html',\r\n})\r\nexport class InridestatusPage implements OnInit {\r\n  rideDateTime: any;\r\n  vId: any;\r\n  distanceKM: any;\r\n  feesValue: any;\r\n  totalSeconds: number = 0;\r\n  Minutes: any;\r\n  hourss: any;\r\n  Seconds: number = 0;\r\n  constructor(private alertCtrl: AlertController, public navCtrl: NavController, public navParams: NavParams,\r\n    private _userState: UserStateProvider, private storage: Storage, public modalController: ModalController,\r\n    private _alertsService: AlertsProvider, public _VehiclsProvider: VehiclsProvider) {\r\n  }\r\n  ngOnInit() {\r\n\r\n  }\r\n\r\n\r\n  setTime() {\r\n    ++this.totalSeconds;\r\n    ++this.Seconds;\r\n    this.hourss = Math.floor(this.totalSeconds / 60 / 60);\r\n    this.Minutes = Math.floor(this.totalSeconds / 60); //this.pad(this.totalSeconds % 60);\r\n    this.Seconds = Number(this.pad(Number(this.Seconds)));//this.pad(Number(this.totalSeconds / 60));\r\n  }\r\n\r\n  pad(val) {\r\n    let valString = val + \"\";\r\n    if (Number(valString) > 60) {\r\n      this.Seconds = 1;\r\n      valString = \"01\";\r\n    }\r\n\r\n    if (valString.length < 2) {\r\n      return \"0\" + valString;\r\n    } else {\r\n      return valString;//.substr(0, 2);\r\n    }\r\n  }\r\n  ionViewDidLoad() {\r\n    this.initTripData();\r\n  }\r\n\r\n  endTrip() {\r\n    let alert = this.alertCtrl.create({\r\n      title: 'End Rabbit !!',\r\n      cssClass: 'alert-class',\r\n      buttons: [\r\n        {\r\n          text: 'Yes',\r\n          handler: () => {\r\n            this.endReservVechil();\r\n            alert.dismiss(true);\r\n            return false;\r\n          }\r\n        }, {\r\n          text: 'No',\r\n          handler: () => {\r\n            alert.dismiss(false);\r\n            return false;\r\n          }\r\n        }\r\n      ]\r\n    });\r\n\r\n    alert.present();\r\n  }\r\n\r\n\r\n  reservationModel: vehicaleReservationModel;\r\n  endReservVechil() {\r\n\r\n    this._alertsService.showConfirmationDialog\r\n    this.storage.get(\"RideStatus\").then(d => {\r\n\r\n      if (d != null) {\r\n        this.reservationModel = <vehicaleReservationModel>d;\r\n\r\n        if (this.reservationModel.reservationEnum == reservationEnum.Start) {\r\n          this.reservationModel.reservationEnum = reservationEnum.End;\r\n\r\n          this._alertsService.showLoader();\r\n\r\n          this._VehiclsProvider.reserve(this.reservationModel).subscribe(returnData => {\r\n            console.log(returnData);\r\n\r\n            this._alertsService.hideLoader();\r\n            if (returnData.IsDone) {\r\n              this.reservationModel.tripId = returnData.ResponseIdStr;\r\n              this.reservationModel.returnObj = returnData.ReturnedObject;\r\n              this._userState.setRideStatus(this.reservationModel);\r\n\r\n\r\n              // Payment\r\n              this.payTrip();\r\n\r\n              let modal = this.modalController.create(\r\n                'EndridePage', null, { enableBackdropDismiss: false, cssClass: 'modal-bottom' }\r\n              );\r\n              modal.present();\r\n\r\n\r\n              //              this.navCtrl.setRoot(\"MapsPage\");\r\n            } else {\r\n              this._alertsService.showWarningToaster(returnData.ErrorMessegesStr);\r\n            }\r\n          });\r\n        }\r\n      }\r\n\r\n    });\r\n  }\r\n\r\n  payTrip() {//tripId: any, amount: any\r\n    this.storage.get(\"RideStatus\").then(d => {\r\n      console.clear();\r\n      console.table(d);\r\n      if (d != null) {\r\n        let reservModel = <vehicaleReservationModel>d;\r\n        console.table(reservModel)\r\n        if (reservModel.reservationEnum == reservationEnum.End) {\r\n          this._VehiclsProvider.byTripId(reservModel.tripId).subscribe(returnData => {\r\n            let ResultData = <ResponseModel>returnData;\r\n\r\n            this._VehiclsProvider.payment1().subscribe(returnData1 => {\r\n              if (returnData1) {\r\n                this._VehiclsProvider.payment2(returnData1.token, ResultData.ReturnedObject.Amount, reservModel.tripId).subscribe(returnData2 => {\r\n\r\n                  this._VehiclsProvider.payment3(returnData1.token, ResultData.ReturnedObject.Amount, returnData2.id, 5046).subscribe(returnData3 => {\r\n\r\n                    // Back to back\r\n                    this.storage.get('UserIDVisaState').then(user => {\r\n                      if (user) {\r\n                        let result = <UserStateModel>user;\r\n                        if (result.Tocken != \"\") {\r\n                          this._VehiclsProvider.paymentBackToBack(returnData1.token, result.Tocken).subscribe(returnDataBack => {\r\n                            if (returnDataBack.obj.success) {\r\n                              // update our data\r\n                              this._VehiclsProvider.paymentOrderSave(reservModel.tripId, returnData2.id).subscribe(returnDataIframe => {\r\n                              });\r\n                            }\r\n                          });\r\n                        }\r\n                      }\r\n                    });\r\n\r\n\r\n                  });\r\n                });\r\n\r\n              }\r\n            });\r\n            // console.log(ResultData)\r\n            // this.rideDateTime = ResultData.ReturnedObject.StartDate;\r\n\r\n            // this.rideDateTime = ResultData.ReturnedObject.StartDate;\r\n            // this.rideDuration = ResultData.ReturnedObject.Duration;\r\n            // this.rideCost = ResultData.ReturnedObject.Amount;\r\n          });\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  initTripData() {\r\n    console.log(this.totalSeconds);\r\n    setInterval(() => {\r\n      this.setTime();\r\n    }, 1000);\r\n\r\n    this.storage.get(\"RideStatus\").then(d => {\r\n      if (d != null) {\r\n        let reservModel = <vehicaleReservationModel>d;\r\n        console.table(reservModel)\r\n        if (reservModel.reservationEnum == reservationEnum.Start) {\r\n\r\n          this._VehiclsProvider.byTripId(reservModel.tripId).subscribe(returnData => {\r\n            let ResultData = <ResponseModel>returnData;\r\n            console.log(ResultData)\r\n            this.rideDateTime = ResultData.ReturnedObject.StartDate;\r\n\r\n            this.rideDateTime = ResultData.ReturnedObject.StartDate;\r\n            this.feesValue = ResultData.ReturnedObject.Amount;\r\n            if (this.feesValue.length > 5) {\r\n              this.feesValue = this.feesValue.substr(0, 5);\r\n            }\r\n            this.totalSeconds = ResultData.ReturnedObject.totalSecounds;\r\n          });\r\n\r\n          this.vId = reservModel.vehicleId;\r\n        }\r\n      }\r\n\r\n    });\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/inridestatus/inridestatus.ts"],"sourceRoot":""}